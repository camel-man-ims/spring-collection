# 섹션2-예제만들기 & 객체지향원리적용

## 1. 환경설정

<img width="937" alt="image" src="https://user-images.githubusercontent.com/51740388/181641876-258a8ea8-a0ff-4c54-afb3-b9e7056ab29e.png">

* 현재 환경
  * 아무것도 추가하지 않으면 아래 2가지 라이브러리만 추가돼있다.

```
implementation 'org.springframework.boot:spring-boot-starter'
testImplementation 'org.springframework.boot:spring-boot-starter-test'
```

<img width="400" alt="image" src="https://user-images.githubusercontent.com/51740388/181643005-8c5e22ea-de11-495f-8b14-65f32c7f787b.png">

<img width="500" alt="image" src="https://user-images.githubusercontent.com/51740388/181643014-57fcf350-47c2-478e-8e84-06e45f8838e2.png">

## 2. 기본 설정

* 아래 그림처럼 interface, 구현체들 생성

<img width="449" alt="2022-07-29_07 08 24" src="https://user-images.githubusercontent.com/51740388/181645641-fdc05b24-8b63-4262-a981-8390242c95e5.png">

<img width="480" alt="2022-07-29_07 09 30" src="https://user-images.githubusercontent.com/51740388/181645782-3104455a-a5cc-46cc-9b1f-93e26c3af08f.png">

## 3. OCP, DIP 위반

```java
public class OrderServiceImpl implements OrderService {
//    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
}
```

* 만약 위와 같이 변경한다면 OCP와 DIP를 위반하게 된다.
  * DIP위반
    * DiscountPolicy 인터페이스 뿐만 아니라, RateDiscountPolicy 객체, 즉 구체 클래스에도 의존하고 있다.
    * <img width="440" alt="2022-08-01_10 33 53" src="https://user-images.githubusercontent.com/51740388/182055942-ea680dad-280f-4f84-ae82-5699189f9025.png">
  * OCP위반
    * 정책을 변경하려면 OrderServiceImpl의 소스코드도 변경해야 한다.
    * <img width="437" alt="2022-08-01_10 33 48" src="https://user-images.githubusercontent.com/51740388/182055949-104d235e-c347-4e08-9823-31def4fca3c9.png">

* OCP,DIP 위반 해결
  * 누군가 DiscountPolicy를 대신 생성해주고 대신 대입해주어야 한다.

```java
public class OrderServiceImpl implements OrderService {
    private DiscountPolicy discountPolicy;
}
```

## 4. AppConfig - 공연기획자의 등장

* 로미오 역할을 누가할 지에 대해서 배우들이 정하는 게 아니다.
  * 공연기획자가 정한다.
* 즉, 책임과 역할을 분리해서, 공연기획자는 섭외만 하고 배우는 연기만 해야 하는 것이다.
* `AppConfig`
  * 구현객체의 생성과 연결을 담당

### 4-1) 생성자 주입

```java
public class MemberServiceImpl implements MemberService{

    private final MemberRepository memberRepository;

    public MemberServiceImpl(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }
    ...
}
```

* 생성자 주입을 통해 문제를 해결한다.

### 4-2) AppConfig.java

```java
public class AppConfig {
    public MemberService memberService(){
        return new MemberServiceImpl(new MemoryMemberRepository());
    }

    public OrderService orderService(){
        return new OrderServiceImpl(new MemoryMemberRepository(),new FixDiscountPolicy());
    }
}
```
